**What is EBS (Elastic Block Store)?**
    * Block-level storage for EC2 instances
    * Behaves like a virtual HDD/SSD
    * Persistent storage → data remains after instance stop/terminate
    * Can attach/detach from EC2 anytime

---

**Difference between EBS and Instance Store**

    * EBS persists → data survives stop/terminate
    * Instance store is ephemeral → data lost on stop/terminate
    * EBS is network-attached
    * Instance store is physically attached to host machine
    * EBS supports snapshots, backups; Instance store doesn’t

---

**Types of EBS Volumes**

    * SSD-based: gp2, gp3, io1, io2
    * HDD-based: st1, sc1
    * gp3 is most recommended
    * io2 for mission-critical workloads
    * st1/sc1 for big data and cold data

---

**Can you decrease EBS volume size?**

    * No
    * Only increase is allowed
    * To reduce size → create new smaller volume → copy data → reattach

---

**What is IOPS in EBS?**

    * Input/Output operations per second
    * Measures read/write speed
    * High IOPS needed for databases

---

**Which EBS type gives highest IOPS?**

    * io2 (up to 256,000 IOPS)
    * Requires Nitro instances

---

**What is Throughput in EBS?**

    * Amount of data transferred per second (MB/s)
    * Important for workloads like analytics, big data, logs

---

**Which EBS type gives highest throughput?**

    * st1 → HDD throughput optimized
    * gp3 also supports high throughput (1000 MB/s)

---

**Difference between gp2 and gp3**

    * gp2 performance depends on size
    * gp3 performance independent of size
    * gp3 cheaper (~20%)
    * gp3 supports defining IOPS and throughput manually

---

**What is an EBS Snapshot?**

    * Point-in-time backup of an EBS volume
    * Stored in Amazon S3 (internally, not user-visible)
    * Incremental in nature
    * Used for disaster recovery

---

**Are EBS snapshots incremental?**

    * Yes
    * Only changed blocks are saved
    * Reduces cost and backup time

---

**Can you create a volume from a snapshot?**

    * Yes
    * Common use case → create AMIs, clone environments

---

**Multi-Attach in EBS — what is it?**

    * A single io1/io2 volume can attach to multiple EC2 instances
    * Up to 16 instances
    * All must be in the same AZ
    * Useful for clustered workloads
    * File system must be cluster-aware (GFS2, OCFS2)

---

**Can gp2/gp3 support Multi-Attach?**

    * No
    * Only io1/io2 support it

---

**EBS Encryption — How does it work?**

    * Managed by AWS KMS
    * Encrypts data at rest, in transit, and snapshots
    * No performance overhead
    * Automatic encryption supported

---

**Can we encrypt an unencrypted EBS volume?**

    * Not directly
    * Create snapshot → create encrypted copy → create encrypted volume → attach

---

**How to increase EBS volume size?**

    * Modify volume → increase size
    * Must extend file system inside OS
    * For ext4 → use `resize2fs`
    * For XFS → use `xfs_growfs`

---

**What happens when you stop an EC2 instance using EBS volume?**

    * Volume remains
    * Data remains
    * You still pay for the EBS volume

---

**What happens when you terminate EC2 with DeleteOnTermination = true?**

    * Root volume gets deleted
    * Attached volumes may or may not delete (depends on config)

---

**Can EBS volumes be moved across AZ?**

    * No
    * Must take snapshot → create volume in another AZ

---

**Difference between EBS Snapshot and AMI**

    * Snapshot → backup of one volume
    * AMI → backup of entire instance (OS, apps, volumes)

---

**What are EBS Burst Credits?** (gp2)

    * gp2 uses burst-bucket model
    * Up to 3000 IOPS temporarily
    * Credits generated by volume size

---

**Does gp3 have burst credits?**

    * No
    * Fixed IOPS and throughput independent of size

---

**How does EBS guarantee durability?**

    * 99.999% durability
    * Replicates data across the entire AZ
    * Not multi-AZ by default

---

**How to create multi-AZ fault tolerance with EBS?**

    * Use snapshots to copy between AZs
    * Or use AWS Backup
    * Or attach volumes to clustered file systems

---

**How to check EBS performance inside OS?**

    * Linux: `iostat`, `iotop`, `/proc/diskstats`
    * Windows: Disk Performance Monitor

---

**Explain EBS-backed AMI**

    * EC2 instance whose root volume is EBS-based
    * Can stop/start
    * Persistent storage
    * Can modify root volume size

---

**What is DeleteOnTermination?**

    * If true → root volume deleted when instance terminates
    * If false → volume persists

---

**How to detach EBS volume safely?**

    * Unmount from OS
    * Then detach from AWS console
    * Prevents corruption

---

**What is EBS Lifecycle Manager?**

    * Automates snapshots
    * Policies for retention, scheduling
    * Useful for backup rotation

---

**Your EBS volume is 100 GB gp2. Application is very slow. How will you identify the bottleneck?**

    * Check CloudWatch metrics:
        * VolumeReadOps, VolumeWriteOps
        * BurstBalance (gp2 credit exhaustion)
        * VolumeQueueLength
    * If BurstBalance < 10% → volume is throttling
    * Use `iostat -xz 1` inside EC2
    * Check average queue length (>1 = bottleneck)
    * If app needs more IOPS → move to gp3 or io2
    * If needs more throughput → move to st1 or gp3

---

**Your EC2 application keeps crashing after attaching a resized EBS volume. What will you check?**

    * Check if file system was extended
    * For ext4 → run `sudo resize2fs /dev/xvda1`
    * For XFS → `sudo xfs_growfs /`
    * Validate partition resizing using `sudo growpart /dev/xvda 1`
    * Check if fstab entry is incorrect → system may fail to boot

---

**Client wants to decrease an EBS volume from 1 TB to 200 GB. How will you do it without losing data?**

    * Take a snapshot of the 1 TB volume
    * Create a 200 GB volume using the snapshot
    * Attach new volume as secondary
    * Mount it and copy data using:
        * `rsync -avh`
        * or `dd` (not recommended)
    * Update fstab on root volume if replacing root
    * Detach old volume

---

**Your EBS gp2 volume suddenly became ‘ReadOnly’. What are possible reasons?**

    * File system corruption due to improper detach
    * Kernel remounted FS read-only due to I/O error
    * Underlying EBS hardware issue (rare)
    * Burst credits exhausted
    * Fix:
        * Run `dmesg | tail`
        * Detach volume, attach to another EC2
        * Run `fsck -y /dev/xvdf1`

---

**An EBS volume is stuck in “optimizing” for hours after modification. What does it mean?**

    * AWS is internally shifting blocks to balance performance
    * Happens when:
        * Making large volume size changes
        * Changing type (gp2 → gp3 / gp2 → io1)
    * Volume is usable; optimization happens in background

---

**Your application needs 50,000 IOPS but the volume is only gp3. What will you change?**

    * Move to io2 Block Express
    * Requires Nitro-based EC2
    * Supports up to 256,000 IOPS
    * Modify volume → change type → io2

---

**You have 2 EC2 instances and both need to write to a single EBS volume. What must you do?**

    * Use EBS Multi-Attach with io1/io2
    * Both instances must be in same AZ
    * Must use shared cluster-aware file system:
        * GFS2
        * OCFS2
    * Ext4/XFS will corrupt data

---

**A snapshot restore is extremely slow. How do you speed up performance immediately?**

    * Use **Fast Snapshot Restore (FSR)**
    * Pre-warm the snapshot
    * Costs extra
    * OR run `fio` sequential reads to warm the volume
    * OR use gp3/io2 volume

---

**Your EBS snapshot contains sensitive data. How do you ensure it never leaves your account?**

    * Use encrypted snapshots with KMS CMK
    * Set snapshot permissions to:
        * Private
        * Block “share”
    * Set IAM SCP policies:
        * Deny ec2:CopySnapshot to external accounts

---

**Your EBS volume is filling up too fast. How do you investigate?**

    * Use `sudo du -sh /*` to find root folders
    * Use `ncdu` for detailed disk usage
    * Check log rotation policies
    * Check if application is writing large tmp files
    * Create CloudWatch alarms for free space

---

**You need to migrate 5 TB EBS volume to another region with least downtime. Steps?**

    * Take a snapshot (incremental)
    * Copy snapshot to target region
    * Create volume in target region
    * Launch EC2 and attach
    * For minimal downtime → Use AWS DataSync

---

**After taking a snapshot, the EC2 becomes slow. Why?**

    * First snapshot triggers **copy-on-write**
    * When data changes → it must be tracked → slows I/O
    * Fix:
        * Use gp3
        * Schedule snapshots during low traffic

---

**Your EC2 root filesystem is full, but volume is already 30 GB. How will you fix it LIVE?**

    * Modify volume → increase to 50 GB
    * Inside OS:
        * `sudo growpart /dev/xvda 1`
        * EXT4: `sudo resize2fs /dev/xvda1`
        * XFS: `sudo xfs_growfs /`
    * No downtime required

---

**Your company wants to stop paying for unused EBS volumes. How will you automate this?**

    * Use AWS Trusted Advisor → “Low Utilization”
    * Use AWS Lambda that:
        * Identifies unattached volumes
        * Deletes after X days
    * Use AWS Backup lifecycle policies

---

**Your multi-attach EBS volume shows corruption. Reason?**

    * Using non-cluster-aware filesystem
    * Applications not designed for concurrent writes
    * Incorrect mount options
    * Not using fencing or locking mechanism

---

**How do you migrate EBS data to S3 for cheaper storage?**

    * Use Data Lifecycle Manager → export snapshots to S3
    * Or:
        * Create snapshot → Export to S3 as AMI → Convert to VMDK
    * Or:
        * Mount S3 using s3fs (not recommended for production)
    * Or AWS DataSync

---

**How do you protect EBS data from accidental deletion?**

    * Enable snapshot retention policies
    * Set DeleteOnTermination = false
    * Use KMS policy: deny decrypt/delete without MFA
    * Tag volumes with “DoNotDelete” and enforce via IAM

---

**Your EBS volume is 16 TB gp2 and throughput is extremely low. What could be the reason?**

    * gp2 throughput scales with size (max 250 MB/s)
    * Requires Nitro instances for max throughput
    * BurstBalance exhausted
    * OS I/O scheduler bottleneck

---

**You restored a 5 TB snapshot. Disk read is extremely slow for the first hour. Why?**

    * First read after restore is lazy-loaded from S3
    * Snapshot blocks are fetched on-demand → slow
    * Solution:
        * Fast Snapshot Restore
        * Pre-warm using `fio`

---

**Your EBS volume shows 16 GB free but app says “No space left on device”. Why?**

    * Inode exhaustion
    * Reserved blocks for root user
    * Wrong mount path (mounted inside itself)

---

**You increased EBS size, but inside OS size is unchanged. Why?**
    * Partition not expanded
    * LVM PV not resized
    * XFS needs `xfs_growfs`

---

**EBS write latency suddenly spikes at 3 AM everyday. How do you debug?**
    * CloudWatch → VolumeWriteOps
    * Check **EBS snapshot schedule**
    * Check CloudWatch Logs retention jobs
    * Check RDS automated backup creation

---

**Your application needs 100k IOPS but you have gp3. What are options?**

    * gp3 max = 16k IOPS
    * Move to:
        * io1 (64k)
        * io2 (256k)
        * io2 Block Express for ultra-high IOPS

---

**You reduced EC2 size (instance type), now EBS IOPS dropped. Why?**

    * Instance’s EBS bandwidth limit is lower
    * Example: t3.micro cannot support high gp3 IOPS
    * EBS performance depends on instance

---

**You attached an encrypted EBS volume to another account. It fails. Why?**

    * CMK is not shared with the target account
    * Instance role does not have KMS Decrypt access

---

**EBS snapshot size is 1 TB but AWS billing shows 2.5 TB. Why?**
    * Snapshots are **incremental**
    * Multiple snapshots exist
    * You are billed for stored changed blocks, not visible size

---

**Snapshot has sensitive data. Team wants to scrub deleted files. How?**
    * Deleted files remain in snapshot
    * Only solution:
        * Create new volume
        * Mount and overwrite free blocks with zero
        * Create new snapshot
        * Delete old snapshot

---

**Application randomly crashes. EBS shows “IO error”. Possible cause?**
    * Underlying hardware issue
    * File system corruption
    * Volume was force-detached
    * Kernel remounted read-only

---

**You want to migrate data from EBS to on-prem. Best approach?**
    * AWS DataSync + NFS
    * Snowball Edge for 10+ TB
    * Rsync over Direct Connect

---

**Multi-Attach EBS is used on two EC2 nodes. Data corruption occurs. Why?**
    * Using ext4/XFS instead of GFS2
    * Not using cluster lock manager
    * Application not cluster-aware

---

**You deleted a snapshot. Another snapshot grew in size. Why?**
    * Incremental snapshots share blocks
    * Deleting parent forces blocks to move to remaining snapshots

---

**Your EBS volume is busy 24/7. You want to reduce IOPS cost. Strategies?**
    * Use gp3 with custom IOPS
    * Use caching layer
    * Move logs to S3
    * Use FSx for Lustre for high read throughput
    * Use RAID0 across multiple volumes

---

**You want to replicate EBS changes to another region with <5 min lag.**

    * Use AWS DataSync scheduled replication
    * Use EBS Multi-region snapshots
    * Or continuous replication via custom rsync + snapshots

---

**After resizing EBS, partition table won’t modify. Why?**

    * Old MBR layout cannot grow above 2 TB
    * Must convert to GPT
    * Requires data migration

---

**EBS burst credits are repeatedly exhausted. How to fix long-term?**

    * Move from gp2 → gp3
    * Or go io1/io2
    * Or increase EBS size to increase baseline throughput

---

**Your app requires 2 million IOPS. Possible?**

    * Single EBS volume → NO
    * Use io2 Block Express + RAID0 striping across 4 volumes

---

**Multi-attach volume disconnects when a node stops. Why?**

    * Fencing not configured
    * Cluster thinks node is alive
    * Causes SCSI-3 Persistent Reservation issues

---

**Snapshots take a long time. How do you speed them?**

    * Use incremental snapshots
    * Use **Block Express volumes**
    * Snapshot → Use Fast Snapshot Restore
    * Ensure volume is not 100% utilized

---

**Restoring from snapshot → OS fails to boot. Why?**

    * Missing boot loader
    * Wrong root device mapping
    * UUID conflict in `/etc/fstab`

---

**You want to clone a 20 TB EBS volume. Fastest method?**

    * Take snapshot
    * Create multiple volumes in parallel
    * Attach to EC2 and copy in parallel using RAID

---

**Some files are missing after you re-attached the volume. How?**

    * Wrong partition was mounted
    * Using LVM and incorrect VG activated
    * Old snapshot used instead of active data

---

**EBS read performance is high but write is slow. Why?**

    * Dirty page cache full
    * gp2/gp3 write throttle
    * Small EC2 instance EBS limit reached
    * Disk-level encryption overhead

---

**Customer wants real-time EBS backup. Possible?**

    * Use CloudEndure Continuous replication
    * Or EBS Multi-Volume Snapshots
    * Or S3-based log shipping

---

**EBS volume shows 0% CPU usage but high latency. Why?**

    * Latency inside EBS network path
    * EC2 → EBS bandwidth limit
    * VolumeQueueLength is high

---

**How to protect EBS from ransomware?**

    * Immutable snapshots
    * IAM deny policies on DeleteVolume
    * KMS Revoke-Grants
    * Backup Vault Lock (Write Once Read Many)

---

**Application writes 2 GB/s but EBS limit is reached. Workaround?**

    * Stripe 4× io2 Block Express volumes in RAID0
    * Use NVMe instance store
    * Use FSx for Lustre
    * Use caching layer (Redis, ElastiCache)

---

**Dev wants to shut down EC2 but keep EBS always mounted while internals restart. Possible?**

    * Not possible.
    * EBS requires a running EC2 to attach
    * Alternative:
        * Use EFS
        * Migrate to FSx
        * Use container persistent volumes

---


**What is an EBS Snapshot?**
      * A snapshot is a point-in-time backup of an EBS volume.
      * It is stored durably inside AWS (internally backed by S3).
      * It can be used to restore EBS volumes or create new ones.
      * It works at the block level, not the file level.
            * EBS does not understand files, folders, or directories.
            * It only knows raw blocks (chunks of data), like 4 KB or 64 KB blocks.
            * EBS stores, reads, and snapshots data by blocks, not by files.
            * EBS doesn’t care what OS you use: Linux, Windows, NTFS, ext4.
            * Faster backups, smaller backups, cheaper backups.

---

**Are EBS snapshots incremental? Explain how**
Yes, EBS snapshots are fully incremental.
How it works:
* Snapshot 1 stores all used blocks.
* Snapshot 2 stores only changed blocks compared to Snapshot 1.
* Snapshot 3 stores only changed blocks compared to Snapshot 2.
Benefits:
* Reduces storage cost.
* Snapshot creation is faster.
* Restore still produces a full, complete volume because AWS combines all required blocks automatically.

---

**What happens if you delete a snapshot?**
      * AWS deletes only the blocks that are unique to that snapshot.
      * Blocks needed by other snapshots are preserved.
      * Deleting an older snapshot does not break later snapshots because AWS shifts dependent blocks to the next snapshot.

---

**Can you create a volume in another Availability Zone using a snapshot?**
Yes.
* Snapshots are Region-wide, not AZ-specific.
* You can restore a snapshot into any AZ within the same Region.
Example:
A snapshot in ap-south-1 can be used to create a volume in:
* ap-south-1a
* ap-south-1b
* ap-south-1c
But not in us-east-1 unless you first copy the snapshot to that region.

---

**Are snapshots stored inside your S3 bucket?**
No.
* Snapshots are stored in AWS’s internal S3 storage, not in your own S3 bucket.
* You cannot view them in the S3 console.
* Billing for snapshots appears under EBS, not S3.

---

**Is snapshot copying across regions supported?**
Yes.
* Snapshots can be copied between regions for migration or disaster recovery.
* After copying, the snapshot can be used to create volumes in the new region.
Example:
Copy snapshot from ap-south-1 to us-east-1, then create volumes in any AZ inside us-east-1.

---

**Why are volumes AZ-specific but snapshots Region-specific?**
**EBS Volume (AZ-specific)**
* Volumes are physically attached over a local storage network within a single AZ.
* They cannot be accessed across AZs due to latency and hardware locality.

**Snapshot (Region-specific)**
* Snapshots are stored in regional S3 storage.
* S3 works at the regional level, so snapshots are accessible from all AZs in that region.

**Summary:**
* EBS Volume = AZ-specific (local block device)
* Snapshot = Region-wide (stored in regional S3-based infrastructure) 